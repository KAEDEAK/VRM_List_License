# VRM_List_License
VRM File Analysis & Folder Sorting Tool Usage Documentation

**Disclaimer:**  
This tool is provided "as is" and should be used at your own risk. The developers assume no responsibility for any damage or issues arising from the use or inability to use this tool.  
Before using this tool, please ensure that you have backed up your files and reviewed the source code.


This tool helps extract metadata related to license and usage restrictions from VRM files. It allows for file listing, JSON/CSV output, and folder sorting based on specified rules.

* Operates on **Python 3.6** or later.

---

## 1. Basic Operation

### 1-1. Listing VRM Files

```
py list_license.py -path <path-pattern>
```

- **Example:**
  ```
  py list_license.py -path test\*.vrm
  ```
- **Operation:**
  Recursively scans the specified path (wildcards allowed) for VRM files and displays each file's license information on the console.

### 1-2. Raw JSON Output

```
py list_license.py -path <path-pattern> -json
```

- **Example:**
  ```
  py list_license.py -path test\*.vrm -json
  ```
- **Operation:**
  Consolidates the parsed JSON from each VRM file into a single output with the format:
  `"files": [ { "filename": "XXX", "metadata": { ... } }, ... ]`.

### 1-3. CSV Output

```
py list_license.py -path <path-pattern> -output <CSV-filename>
```

- **Example:**
  ```
  py list_license.py -path test\*.vrm -output list.csv
  ```
- **Operation:**
  Extracts the license information from the specified VRM files and outputs it as a CSV file in a standardized format.

---

## 2. Folder Sorting Feature

This feature automatically moves VRM files into folders based on their license and usage restriction information. The sorting process is divided into two main phases: "Preparation Mode" and "Sort Mode".

### Step 1: Creating mapdata.json (Preparation Mode)

First, the tool collects all metadata related to licenses and usage restrictions from the target VRM files and automatically generates a `mapdata.json` file in a **unique key-value** format (no duplicates).

```
py list_license.py -path <path-pattern> -mapToFolder -prepare <path-to-mapdata.json>
```

- **Example:**
  ```
  py list_license.py -path test\*.vrm -mapToFolder -prepare mapdata.json
  ```
- **Sample Output of mapdata.json:**

```json
{
  "mapdata": {
    "unsort": {
      "target": {
        "allowedUserName": ["Everyone", "OnlyAuthor"],
        "commercialUssageName": ["Disallow", "Allow"],
        "licenseName": "Other",
        "sexualUssageName": ["Disallow", "Allow"],
        "violentUssageName": ["Disallow", "Allow"],
        "licenseUrl": "https://vrm.dev/licenses/1.0/",
        "avatarPermission": "everyone",
        "allowExcessivelyViolentUsage": true,
        "allowExcessivelySexualUsage": true,
        "commercialUsage": ["personalNonProfit", "corporation"],
        "creditNotation": ["unnecessary", "required"],
        "allowRedistribution": [false, true],
        "modification": ["allowModificationRedistribution", "prohibited", "allowModification"]
      }
    },
    "sorted": [{
        "directory": "folder-1",
        "target": {}
      }, {
        "directory": "folder-2",
        "target": {}
      }, {
        "directory": "DoNotUse",
        "target": {}
      }
    ]
  }
}
```

- **Example of Editing mapdata.json:**

```json
{
  "mapdata": {
    "unsort": {
      "target": {
        "allowedUserName": ["This value is automatically generated by the -prepare parameter."]
      }
    },
    "sorted": [{
        "directory": "OpenUse",
        "target": {
          "allowedUserName": ["OnlyAuthor"],
          "commercialUssageName": ["Allow"],
          "sexualUssageName": ["Allow"],
          "violentUssageName": ["Allow"],
          "avatarPermission": "everyone",
          "allowExcessivelyViolentUsage": true,
          "allowExcessivelySexualUsage": true,
          "commercialUsage": ["corporation", "personalNonProfit"],
          "creditNotation": ["unnecessary"],
          "allowRedistribution": [true],
          "modification": ["allowModification", "allowModificationRedistribution"]
        }
      }, {
        "directory": "LimitedUse",
        "target": {
          "allowedUserName": ["Everyone"],
          "commercialUssageName": ["Allow"],
          "allowRedistribution": [true]
        }
      }, {
        "directory": "ReviewRequired",
        "target": {}
      }
    ]
  }
}
```

- **Key Points:**
  - The `unsort.target` section records the keys and values related to licenses and usage restrictions collected by the tool.
  - The `sorted` section is intended for the user to later edit and set folder sorting rules (conditions).
  - *Note:* Ensure the JSON is correctly formatted with **keys and strings enclosed in double quotes**. Booleans and integers can remain as-is!

### Step 2: Sorting Files Based on mapdata.json (Sort Mode)

After editing mapdata.json to set the conditions (target) for moving files to specific folders, execute the following command to perform file sorting.

```
py list_license.py -path <path-pattern> -mapToFolder -sortBy <path-to-mapdata.json>
```

- **Example:**
  ```
  py list_license.py -path test\*.vrm -mapToFolder -sortBy mapdata.json
  ```
- **Operation Details:**
  - The key-value conditions specified in each mapping's `target` are evaluated using an **AND** logic.  
    â†’ When multiple conditions are specified, only files that meet all conditions are moved to the corresponding directory.
  - If a file does not match any mapping's conditions and there is an entry with `directory` set to `"ReviewRequired"` with an empty `target`, the file will be moved to that folder.

---

## 3. Additional Notes and Precautions

- **Python Environment:**
  Operates on Python 3.6 or later. Only standard libraries are required.

- **About JSON Formatting:**
  - Strings must always be enclosed in double quotes (`" "`).
  - Booleans (true, false) and integers can remain as-is!
  - Be careful to avoid extra commas.
  - It is advisable to validate the JSON format using tools like JSONLint.

- **Target Files:**
  Supports VRM 0.x and VRM 1.0 files. Files in other formats will not be processed, so please take note.

---
